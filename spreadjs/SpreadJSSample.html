<!DOCTYPE html>
<html>
<head>
	<title>CSVのインポート／エクスポート</title>
	<!-- SpreadJSのカルチャ設定 ……（1）-->
	<meta name="spreadjs culture" content="ja-jp"/>

	<!-- jQuery、jQurey UI ……（2） -->
	<script src="http://code.jquery.com/jquery-1.9.1.min.js" type="text/javascript"></script>
	<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.min.js" type="text/javascript"></script>
	 
	<!-- WijmoテーマCSS ……（3）-->
	<link href="http://cdn.wijmo.com/themes/aristo/jquery-wijmo.css" rel="stylesheet" type="text/css" />
	 
	<!-- SpreadJSスクリプト ……（4） -->
	<script src="http://cdn.wijmo.com/spreadjs/jquery.wijmo.wijspread.all.3.20141.10.min.js" type="text/javascript"></script>
	 
	<!-- SpreadJSテーマCSS ……（5）-->
	<link href="http://cdn.wijmo.com/spreadjs/jquery.wijmo.wijspread.3.20141.10.css" rel="stylesheet" type="text/css" />

	<script type="text/javascript">
		$(function () {
	    	// SpreadJSの初期化
		    $("#wijspread1").wijspread();
			var reader = new FileReader();
			//テキスト形式で読み込む
			reader.readAsText("codezine.csv");
			  //読込終了後の処理
			alert("pp");
			reader.onload = function(ev){
			//テキストエリアに表示する
			var csvdata = reader.result;
			alert(csvdata);
			$("txt").value=reader.result;
			}
		});
        
        $("#button1").click(function(){
    		window.CSVString = spread.getSheet(0).getCsv(0, 0, spread.getSheet(0).getRowCount(), spread.getSheet(0).getColumnCount(), "\r", ",");
        });
        
        $("#button2").click(function(){
        	//FileReaderの作成
        	$("txt").value="ddd";
			var reader = new FileReader();
			//テキスト形式で読み込む
			reader.readAsText("codezine.csv");
			  //読込終了後の処理
			alert("pp");
			reader.onload = function(ev){
			//テキストエリアに表示する
			var csvdata = reader.result;
			alert(csvdata);
			$("txt").value=reader.result;
			}
    	spread.getSheet(0).setCsv(0, 0, csvdata, "\r", ",", $.wijmo.wijspread.TextFileOpenFlags.None);
        });
                
	</script>
</head>
<body>
	<div id="wijspread1" style="width: 480px; height: 320px; border: 1px solid gray">
    <input type="button" id="button1" value="button1"/>
    <input type="button" id="button2" value="button2"/>
    <textarea name="txt" rows="10" cols="50" readonly></textarea>


</body>
</html>